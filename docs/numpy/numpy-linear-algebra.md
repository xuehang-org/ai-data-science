---
title: NumPy 统计函数
---

# 17. NumPy 线性代数

NumPy 提供了强大的线性代数功能，允许你执行矩阵运算、求解线性方程组、计算特征值和特征向量等。 线性代数是很多科学计算和数据分析的基础，NumPy 使得在 Python 中进行这些计算变得非常方便。

## 17.1 矩阵和向量操作

### 17.1.1 创建矩阵

首先，我们需要创建矩阵。NumPy 的 `ndarray` 对象非常适合表示矩阵。

```python
import numpy as np

# 创建一个 2x3 的矩阵
A = np.array([[1, 2, 3], [4, 5, 6]])
print("矩阵 A:\n", A)
```

输出：

```
矩阵 A:
 [[1 2 3]
 [4 5 6]]
```

### 17.1.2 矩阵转置

可以使用 `.T` 属性或 `np.transpose()` 函数进行矩阵转置。

```python
# 矩阵转置
A_T = A.T
print("矩阵 A 的转置:\n", A_T)

# 或者使用 np.transpose()
A_T2 = np.transpose(A)
print("矩阵 A 的转置 (使用 np.transpose()):\n", A_T2)
```

输出：

```
矩阵 A 的转置:
 [[1 4]
 [2 5]
 [3 6]]
矩阵 A 的转置 (使用 np.transpose()):
 [[1 4]
 [2 5]
 [3 6]]
```

### 17.1.3 矩阵加法和减法

矩阵加法和减法要求矩阵的形状相同。

```python
B = np.array([[7, 8, 9], [10, 11, 12]])

# 矩阵加法
C = A + B
print("矩阵 A + B:\n", C)

# 矩阵减法
D = A - B
print("矩阵 A - B:\n", D)
```

输出：

```
矩阵 A + B:
 [[ 8 10 12]
 [14 16 18]]
矩阵 A - B:
 [[-6 -6 -6]
 [-6 -6 -6]]
```

### 17.1.4 矩阵乘法

NumPy 提供了 `np.dot()` 函数和 `@` 运算符来进行矩阵乘法。

```python
# 创建一个 3x2 的矩阵
E = np.array([[1, 2], [3, 4], [5, 6]])

# 矩阵乘法 (A 是 2x3, E 是 3x2)
F = np.dot(A, E)
print("矩阵 A * E (使用 np.dot()):\n", F)

# 或者使用 @ 运算符
F2 = A @ E
print("矩阵 A * E (使用 @ 运算符):\n", F2)
```

输出：

```
矩阵 A * E (使用 np.dot()):
 [[22 28]
 [49 64]]
矩阵 A * E (使用 @ 运算符):
 [[22 28]
 [49 64]]
```

**注意:** 矩阵乘法要求第一个矩阵的列数等于第二个矩阵的行数。

## 17.2 线性方程组求解

NumPy 的 `linalg.solve()` 函数可以用来求解线性方程组。

例如，对于以下方程组：

```
x + 2y = 5
3x + 4y = 13
```

可以表示为矩阵形式 `Ax = b`，其中：

```
A = [[1, 2], [3, 4]]
x = [[x], [y]]
b = [[5], [13]]
```

求解代码如下：

```python
import numpy as np
from numpy import linalg

# 定义矩阵 A 和向量 b
A = np.array([[1, 2], [3, 4]])
b = np.array([5, 13])

# 求解线性方程组
x = linalg.solve(A, b)
print("方程组的解:\n", x)
```

输出：

```
方程组的解:
 [-1.  3.]
```

所以，x = -1，y = 3。

## 17.3 矩阵的逆

可以使用 `linalg.inv()` 函数计算矩阵的逆。  只有方阵才有逆矩阵。

```python
# 创建一个方阵
A = np.array([[1, 2], [3, 4]])

# 计算矩阵的逆
A_inv = linalg.inv(A)
print("矩阵 A 的逆:\n", A_inv)
```

输出：

```
矩阵 A 的逆:
 [[-2.   1. ]
 [ 1.5 -0.5]]
```

可以验证 `A` 乘以 `A` 的逆等于单位矩阵：

```python
# 验证 A * A_inv 是否为单位矩阵
I = A @ A_inv
print("A * A_inv:\n", I)
```

输出：

```
A * A_inv:
 [[1.00000000e+00 0.00000000e+00]
 [8.88178420e-16 1.00000000e+00]]
```

由于浮点数精度问题，结果可能不是完全的单位矩阵，但非常接近。

## 17.4 行列式

使用 `linalg.det()` 函数计算矩阵的行列式。

```python
# 计算矩阵 A 的行列式
det_A = linalg.det(A)
print("矩阵 A 的行列式:", det_A)
```

输出：

```
矩阵 A 的行列式: -2.0
```

## 17.5 特征值和特征向量

使用 `linalg.eig()` 函数计算矩阵的特征值和特征向量。

```python
# 计算矩阵 A 的特征值和特征向量
eigenvalues, eigenvectors = linalg.eig(A)

print("特征值:", eigenvalues)
print("特征向量:\n", eigenvectors)
```

输出：

```
特征值: [-0.37228132  5.37228132]
特征向量:
 [[-0.82456484 -0.41597356]
 [ 0.56576746 -0.90937671]]
```

每个特征值对应一个特征向量。  特征向量在乘以原始矩阵时，其方向不变，只缩放特征值倍。

## 17.6 奇异值分解

奇异值分解是一种重要的矩阵分解方法，NumPy 提供了 `linalg.svd()` 函数来执行 SVD。

```python
# 创建一个矩阵
A = np.array([[1, 2], [3, 4], [5, 6]])

# 进行奇异值分解
U, s, V = linalg.svd(A)

print("U:\n", U)
print("s:", s)
print("V:\n", V)
```

输出：

```
U:
 [[-0.2298477   0.88346102  0.40824829]
 [-0.52474494  0.24078249 -0.81649658]
 [-0.81964217 -0.39911604  0.40824829]]
s: [9.52551809 0.51430064]
V:
 [[-0.61962948 -0.78489445]
 [-0.78489445  0.61962948]]
```

`U` 和 `V` 是酉矩阵，`s` 是奇异值向量。可以使用这些结果重构原始矩阵 `A`。

## 17.7 总结

NumPy 的线性代数模块提供了丰富的函数，可以进行矩阵运算、求解线性方程组、计算特征值和特征向量、执行奇异值分解等。掌握这些功能对于进行科学计算和数据分析至关重要。希望这些示例能帮助你更好地理解和使用 NumPy 的线性代数功能。